import sys
from ptrlib import *

num = [
    "([]>[[]])",  # 0
    "([]<[[]])",  # 1
    "([]<[[]])+([]<[[]])",  # 2
    "([]<[[]])+([]<[[]])+([]<[[]])",  # 3
    "(([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))",  # 4 = 2^2
    "([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])",  # 5
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]]))",  # 6 = 3*2
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]]))+([]<[[]])",  # 7 = 3*2+1
    "(([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]])+([]<[[]]))",  # 8 = 2^3
    "(([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))",  # 9 = 3^2
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]]))",  # 10 = 5*2
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]]))+([]<[[]])",  # 11 = 5*2+1
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 12 = 3*4
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 13 = 3*4+1
    "(([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 14 = 2*7
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 15 = 3*5
    "(([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 16 = 2^4
    "(([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 17 = 2^4+1
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 18 = 3*6
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 19 = 3*6+1
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 20 = 4*5
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 21 = 3*7
    "(([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 22 = 2*11
    "(([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 23 = 2*11+1
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 24 = 3*8
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))",  # 25 = 5^2
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))+([]<[[]])",  # 26 = 5^2+1
    "(([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]])+([]<[[]]))",  # 27 = 3^3
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 28 = 4*7
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 29 = 4*7+1
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 30 = 3*10
    "(([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 31 = 3*10+1
    "(([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 32 = 2^5
    "(([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))+([]<[[]])",  # 33 = 2^5+1
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))-(([]<[[]])+([]<[[]]))",  # 34 = 6^2-2
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 35 = 7*5
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))",  # 36 = 6^2
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))+([]<[[]])",  # 37 = 6^2+1
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))+(([]<[[]])+([]<[[]]))",  # 38 = 6^2+2
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))**(([]<[[]])+([]<[[]]))+(([]<[[]])+([]<[[]])+([]<[[]]))",  # 39 = 6^2+3
    "(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))*(([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]])+([]<[[]]))",  # 40 = 4*10
]

logger.setLevel("CRITICAL")

FLAG = ""
# FLAG = "Securinets{H0p3_Y0u_L0ST_"

for i in num[len(FLAG) :]:

    sock = Socket("nc misc-b6c94dd8.p1.securinets.tn 7000")

    sock.sendlineafter(b"> ", "abcdefghijklmnopqrstuvwxyz")
    _ = sock.recvline()
    shifted = sock.recvline().decode()
    conv = str.maketrans(shifted, "abcdefghijklmnopqrstuvwxyz")

    code = f"flag[{i}]".translate(conv)

    while True:
        sock.sendlineafter(b"> ", code)
        _ = sock.recvline()
        res = sock.recvline().decode()
        if len(res) == 1:
            FLAG += res
            print(f"FLAG: {FLAG}")
            if res == "}":
                sys.exit(0)
            sock.close()
            break
